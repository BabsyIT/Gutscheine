<!doctype html><html lang="de"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <title>Babsy Partnergutscheine</title> <script src="/_sdk/data_sdk.js"></script> <script src="/_sdk/element_sdk.js"></script> <script src="https://cdn.tailwindcss.com"></script> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"> <style> :root{ --primary-color:#a71a80; --secondary-color:#009fad; --background-color:#f3f4f6; --card-color:#ffffff; --text-color:#1f2937; } html,body{height:100%;margin:0;padding:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto, sans-serif;background:var(--background-color);color:var(--text-color)} .container{max-width:1200px;margin:0 auto;padding:40px 20px} header.babsy-header{position:fixed;top:0;left:0;right:0;background:var(--card-color);box-shadow:0 1px 8px rgba(0,0,0,0.05);z-index:60} .babsy-nav{display:flex;align-items:center;justify-content:space-between;max-width:1200px;margin:0 auto;padding:12px 20px} .babsy-logo{font-weight:700;color:var(--primary-color);text-decoration:none} .babsy-nav-links{display:flex;gap:14px;list-style:none;padding:0;margin:0} .babsy-nav-links a{color:var(--text-color);text-decoration:none} .babsy-mobile-menu{display:none;background:none;border:0} @media(max-width:768px){.babsy-mobile-menu{display:block}.babsy-nav-links{display:none}.babsy-nav-links.active{display:flex;flex-direction:column;position:absolute;top:60px;left:0;right:0;background:var(--card-color);padding:10px 20px;box-shadow:0 8px 24px rgba(0,0,0,0.08)}} .page-header{text-align:center;margin-bottom:24px;padding-top:20px} .page-header h1{font-size:28px;color:var(--primary-color);margin:0} .grid-areas{display:grid;grid-template-columns:1fr;gap:20px} @media(min-width:900px){.grid-areas{grid-template-columns:360px 1fr}} .card{background:var(--card-color);padding:20px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.06)} .stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px} .stat-card{text-align:center;padding:16px;border-radius:10px} .filters{display:flex;gap:10px;flex-wrap:wrap;margin:12px 0} .filter-btn{padding:8px 14px;border:2px solid var(--secondary-color);background:#fff;color:var(--secondary-color);border-radius:999px;cursor:pointer;font-weight:700} .filter-btn.active{background:var(--secondary-color);color:#fff} .vouchers-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px} .voucher-card{border-radius:12px;overflow:hidden;transition:transform .18s,box-shadow .18s} .voucher-card:hover{transform:translateY(-4px);box-shadow:0 8px 20px rgba(0,0,0,0.08)} .voucher-header{background:linear-gradient(135deg,var(--primary-color),var(--secondary-color));color:#fff;padding:18px;position:relative} .voucher-status{position:absolute;top:10px;right:10px;padding:5px 12px;border-radius:20px;font-weight:700;font-size:12px} .voucher-status.active{background:#10b981} .voucher-status.redeemed{background:#6b7280} .voucher-code{background:rgba(255,255,255,0.15);padding:8px;border-radius:8px;text-align:center;font-family:monospace;margin-top:8px} .voucher-body{padding:16px;background:var(--card-color);color:var(--text-color)} .voucher-info label{font-weight:700;font-size:12px;color:#666} .voucher-actions{display:flex;gap:10px;margin-top:14px} .btn-email{background:var(--secondary-color);color:#fff;padding:10px;border-radius:8px;border:0;flex:1} .btn-delete{background:#ef4444;color:#fff;padding:10px;border-radius:8px;border:0;flex:1} .empty-state{text-align:center;padding:40px} .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:2000;align-items:center;justify-content:center} .modal.active{display:flex} .modal-content{background:#fff;padding:24px;border-radius:12px;max-width:540px;width:92%} .toast{position:fixed;top:20px;right:20px;padding:12px 18px;border-radius:8px;color:#fff;z-index:3000;box-shadow:0 6px 20px rgba(0,0,0,0.12)} /* small layout tweaks for registration form */ form.grid-two{display:grid;gap:10px} @media(min-width:768px){form.grid-two{grid-template-columns:1fr 1fr}} </style> </head> <body> <header class="babsy-header"> <nav class="babsy-nav container"> <a class="babsy-logo" href="#"> <i class="fas fa-ticket-alt"></i> Babsy Partnergutscheine </a> <ul class="babsy-nav-links" id="navLinks"> <li><a href="#home">üè† Startseite</a></li> <li><a href="#vouchers">üé´ Meine Gutscheine</a></li> <li><a href="#karte">üó∫Ô∏è Partner-Karte</a></li> </ul> <button class="babsy-mobile-menu" id="mobileMenu"><i class="fas fa-bars"></i></button> </nav> </header> <main class="container" id="app" style="padding-top:88px"> <div class="page-header"> <h1><i class="fas fa-gift"></i> Babsy Partnergutscheine</h1> <p class="text-sm text-gray-600">Verwalten Sie Ihre Gutscheine ‚Äî erstellen, einl√∂sen, versenden</p> </div><div class="grid-areas"> <!-- Left column: Registration + Actions + Stats --> <div class="space-y-6"> <div class="card"> <h2 class="text-xl font-bold mb-3">Registrierung f√ºr Partnergutscheine</h2> <form id="registration-form" class="grid-two"> <div> <label class="block font-semibold mb-1" for="first-name">Vorname *</label> <input id="first-name" required class="w-full px-3 py-2 border rounded" /> </div> <div> <label class="block font-semibold mb-1" for="last-name">Nachname *</label> <input id="last-name" required class="w-full px-3 py-2 border rounded" /> </div> <div style="grid-column:1/-1"> <label class="block font-semibold mb-1" for="email">E-Mail *</label> <input id="email" type="email" required class="w-full px-3 py-2 border rounded" /> </div> <div style="grid-column:1/-1" class="space-y-2"> <label class="inline-flex items-center"><input id="newsletter" type="checkbox" required class="mr-2" /> Ich stimme dem Erhalt des Newsletters zu *</label> </div> <div style="grid-column:1/-1"> <button id="register-btn" type="submit" class="w-full bg-[var(--primary-color)] text-white px-4 py-2 rounded font-semibold">Registrieren</button> </div> </form> </div> <div class="card"> <div class="flex gap-3"> <button id="create-btn" class="flex-1 px-4 py-2 rounded bg-[var(--primary-color)] text-white font-semibold">‚ú® Gutschein erstellen</button> <button id="redeem-btn" class="flex-1 px-4 py-2 rounded bg-[var(--secondary-color)] text-white font-semibold">üéÅ Gutschein einl√∂sen</button> </div> </div> <div class="card"> <h3 class="font-bold mb-3">Statistiken</h3> <div class="stats"> <div class="stat-card total card"> <i class="fas fa-ticket-alt text-2xl" style="color:var(--primary-color)"></i> <div class="number text-2xl font-bold" id="totalCount">0</div> <div class="label">Gesamt</div> </div> <div class="stat-card active card"> <i class="fas fa-check-circle text-2xl" style="color:#10b981"></i> <div class="number text-2xl font-bold" id="activeCount">0</div> <div class="label">Aktiv</div> </div> <div class="stat-card redeemed card"> <i class="fas fa-times-circle text-2xl" style="color:#6b7280"></i> <div class="number text-2xl font-bold" id="redeemedCount">0</div> <div class="label">Eingel√∂st</div> </div> </div> </div> </div> <!-- Right column: Filters + Voucher Grid --> <div> <div class="card mb-4"> <div class="filters"> <button class="filter-btn active" data-filter="all"> <i class="fas fa-list"></i> Alle</button> <button class="filter-btn" data-filter="active"> <i class="fas fa-check-circle"></i> Aktiv</button> <button class="filter-btn" data-filter="redeemed"> <i class="fas fa-times-circle"></i> Eingel√∂st</button> </div> </div> <div id="vouchersArea"> <div class="vouchers-grid" id="vouchersGrid"><!-- vouchers rendered here --></div> <div class="empty-state" id="emptyState" style="display:none;"> <i class="fas fa-ticket-alt fa-3x" style="color:#d1d5db"></i> <h3 class="mt-4">Keine Gutscheine vorhanden</h3> <p class="text-gray-500">Erstellen Sie Ihren ersten Gutschein oder importieren Sie Daten</p> </div> </div> </div> </div> </main> <!-- Create Modal --> <div id="create-modal" class="modal" aria-hidden="true"> <div class="modal-content"> <h3 class="text-2xl font-bold mb-4">Neuen Gutschein erstellen</h3> <form id="create-form"> <div class="mb-4"> <label for="voucher-partner" class="block font-semibold mb-2">Gutschein ausw√§hlen</label> <select id="voucher-partner" required class="w-full px-3 py-2 border rounded bg-white"> <option value="">Bitte Gutschein ausw√§hlen...</option> <option value="Restaurant Bella Vista|Abendessen f√ºr 2 Personen|Genie√üen Sie ein romantisches 3-G√§nge-Men√º">üçΩÔ∏è Restaurant Bella Vista - Abendessen f√ºr 2 Personen</option> <option value="Wellness Oase|60 Min Entspannungsmassage|Lassen Sie sich bei einer wohltuenden Ganzk√∂rpermassage verw√∂hnen">üíÜ‚Äç‚ôÄÔ∏è Wellness Oase - 60 Min Entspannungsmassage</option> <option value="Kino Metropol|2 Kinokarten + Popcorn|Erleben Sie die neuesten Blockbuster mit Snacks">üé¨ Kino Metropol - 2 Kinokarten + Popcorn</option> <option value="Fitness Studio Power|1 Monat Mitgliedschaft|Trainieren Sie einen Monat kostenlos in unserem Studio">üí™ Fitness Studio Power - 1 Monat Mitgliedschaft</option> <option value="Caf√© Gem√ºtlich|Kaffee &amp; Kuchen f√ºr 2|Genie√üen Sie hausgemachten Kuchen mit frischem Kaffee">‚òï Caf√© Gem√ºtlich - Kaffee &amp; Kuchen f√ºr 2</option> <option value="Buchhandlung Lesezeit|B√ºchergutschein 25‚Ç¨|St√∂bern Sie in unserem Sortiment und w√§hlen Sie Ihre Lieblingsb√ºcher">üìö Buchhandlung Lesezeit - B√ºchergutschein 25‚Ç¨</option> <option value="Friseur Sch√∂nheit|Waschen, Schneiden, F√∂hnen|Lassen Sie sich von unserem Profi-Team verw√∂hnen">‚úÇÔ∏è Friseur Sch√∂nheit - Waschen, Schneiden, F√∂hnen</option> <option value="Blumen Paradies|Blumenstrau√ü nach Wahl|√úberraschen Sie Ihre Liebsten mit einem frischen Blumenstrau√ü">üå∏ Blumen Paradies - Blumenstrau√ü nach Wahl</option> <option value="B√§ckerei Goldkruste|Fr√ºhst√ºck f√ºr 2 Personen|Starten Sie den Tag mit frischen Backwaren und Kaffee">ü•ñ B√§ckerei Goldkruste - Fr√ºhst√ºck f√ºr 2 Personen</option> <option value="Apotheke Gesundheit|Beratung + Wellness-Paket|Professionelle Beratung mit hochwertigen Wellness-Produkten">üíä Apotheke Gesundheit - Beratung + Wellness-Paket</option> </select> </div> <div class="flex gap-3"> <button id="create-submit-btn" type="submit" class="flex-1 bg-[var(--primary-color)] text-white px-4 py-2 rounded">Gutschein erstellen</button> <button id="create-cancel-btn" type="button" class="flex-1 bg-[var(--secondary-color)] text-white px-4 py-2 rounded">Abbrechen</button> </div> </form> </div> </div> <!-- Redeem Modal --> <div id="redeem-modal" class="modal" aria-hidden="true"> <div class="modal-content"> <h3 class="text-2xl font-bold mb-4">Gutschein einl√∂sen</h3> <form id="redeem-form"> <div class="mb-4"> <label for="redeem-code" class="block font-semibold mb-2">Gutschein-Code</label> <input id="redeem-code" required placeholder="XXXX-XXXX" class="w-full px-3 py-2 border rounded uppercase" /> </div> <div class="flex gap-3"> <button id="redeem-submit-btn" type="submit" class="flex-1 bg-[var(--primary-color)] text-white px-4 py-2 rounded">Einl√∂sen</button> <button id="redeem-cancel-btn" type="button" class="flex-1 bg-[var(--secondary-color)] text-white px-4 py-2 rounded">Abbrechen</button> </div> </form> </div> </div> <!-- Email Modal --> <div class="modal" id="emailModal" aria-hidden="true"> <div class="modal-content"> <h2 class="text-2xl font-bold mb-3"><i class="fas fa-envelope"></i> Gutschein per E-Mail versenden</h2> <form id="emailForm"> <div class="form-group mb-3"> <label for="recipientEmail" class="block font-semibold mb-1">E-Mail-Adresse des Empf√§ngers</label> <input id="recipientEmail" type="email" required class="w-full px-3 py-2 border rounded" placeholder="beispiel@email.com" /> </div> <div class="form-group mb-3"> <label for="senderName" class="block font-semibold mb-1">Ihr Name (optional)</label> <input id="senderName" class="w-full px-3 py-2 border rounded" placeholder="Max Mustermann" /> </div> <div class="modal-actions flex gap-3"> <button class="btn-send flex-1 bg-[var(--primary-color)] text-white px-4 py-2 rounded" type="submit"><i class="fas fa-paper-plane"></i> Senden</button> <button type="button" class="btn-cancel flex-1 bg-gray-200 text-gray-700 px-4 py-2 rounded" onclick="closeEmailModal()">Abbrechen</button> </div> </form> </div> </div> <div id="toast-wrapper"></div> <script> // Shared state let vouchers = []; let currentFilter = 'all'; let selectedVoucher = null; const defaultConfig = { background_color: "#f3f4f6", card_color: "#ffffff", text_color: "#1f2937", primary_action_color: "#a71a80", secondary_action_color: "#009fad", page_title: "Babsy Partnergutscheine", create_button_text: "Gutschein erstellen", redeem_button_text: "Gutschein einl√∂sen", font_family: "system-ui", font_size: 16 }; // Utility: show toast function showToast(message, type = 'success') { const wrapper = document.getElementById('toast-wrapper'); const toast = document.createElement('div'); toast.className = 'toast'; toast.style.backgroundColor = type === 'success' ? defaultConfig.primary_action_color : '#dc2626'; toast.textContent = message; wrapper.appendChild(toast); setTimeout(() => toast.remove(), 3000); } // Voucher code generator function generateVoucherCode() { const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'; let code = ''; for (let i = 0; i < 8; i++) { if (i === 4) code += '-'; code += chars.charAt(Math.floor(Math.random() * chars.length)); } return code; } // Persistence wrappers: dataSdk preferred, otherwise localStorage async function loadVouchersFromStorage() { if (window.dataSdk && window.dataSdk.getAll) { try { const res = await window.dataSdk.getAll(); if (res && Array.isArray(res)) { vouchers = res.sort((a,b)=>new Date(b.createdAt)-new Date(a.createdAt)); return; } } catch(e){/*fallback*/} } const stored = localStorage.getItem('babsy_vouchers'); vouchers = stored ? JSON.parse(stored) : []; } async function persistVouchersToStorage() { if (window.dataSdk && window.dataSdk.setAll) { try { await window.dataSdk.setAll(vouchers); return; } catch(e){/*fallback*/} } localStorage.setItem('babsy_vouchers', JSON.stringify(vouchers)); } async function createVoucherBackend(voucher) { if (window.dataSdk && window.dataSdk.create) { const result = await window.dataSdk.create(voucher); return result; } else { vouchers.unshift(voucher); await persistVouchersToStorage(); // simulate result return { isOk: true }; } } async function updateVoucherBackend(voucher) { if (window.dataSdk && window.dataSdk.update) { const result = await window.dataSdk.update(voucher); return result; } else { vouchers = vouchers.map(v => v.id === voucher.id ? voucher : v); await persistVouchersToStorage(); return { isOk: true }; } } async function deleteVoucherBackend(id) { if (window.dataSdk && window.dataSdk.delete) { const result = await window.dataSdk.delete(id); return result; } else { vouchers = vouchers.filter(v => v.id !== id); await persistVouchersToStorage(); return { isOk: true }; } } // Rendering function updateStats() { const total = vouchers.length; const active = vouchers.filter(v => !v.isRedeemed).length; const redeemed = vouchers.filter(v => v.isRedeemed).length; document.getElementById('totalCount').textContent = total; document.getElementById('activeCount').textContent = active; document.getElementById('redeemedCount').textContent = redeemed; } function renderVouchers() { const grid = document.getElementById('vouchersGrid'); const emptyState = document.getElementById('emptyState'); let filtered = vouchers; if (currentFilter === 'active') filtered = vouchers.filter(v => !v.isRedeemed); if (currentFilter === 'redeemed') filtered = vouchers.filter(v => v.isRedeemed); if (!filtered || filtered.length === 0) { grid.style.display = 'none'; emptyState.style.display = 'block'; return; } emptyState.style.display = 'none'; grid.style.display = 'grid'; grid.innerHTML = filtered.map(v => ` <div class="voucher-card card"> <div class="voucher-header"> <span class="voucher-status ${v.isRedeemed ? 'redeemed' : 'active'}">${v.isRedeemed ? '‚úì Eingel√∂st' : '‚óè Aktiv'}</span> <h3 class="text-lg font-bold">${escapeHtml(v.partner)}</h3> <div class="voucher-code">${escapeHtml(v.code)}</div> </div> <div class="voucher-body"> <div class="voucher-info mb-3"><label>Beschreibung</label><p>${escapeHtml(v.description)}</p></div> <div class="voucher-info mb-2"><label>Erstellt am</label><p>${new Date(v.createdAt).toLocaleDateString('de-DE', {year:'numeric',month:'long',day:'numeric'})}</p></div> ${v.isRedeemed ? `<div class="voucher-info mb-2"><label>Eingel√∂st am</label><p>${new Date(v.redeemedAt).toLocaleDateString('de-DE', {year:'numeric',month:'long',day:'numeric'})}</p></div>` : ''} <div class="voucher-actions"> ${!v.isRedeemed ? `<button class="btn-email" onclick="openEmailModal('${v.id}')"><i class="fas fa-envelope"></i> E-Mail</button>` : ''} ${!v.isRedeemed ? `<button class="btn-email" onclick="openRedeemModalWithCode('${v.code}')" style="background:#f59e0b">Einl√∂sen</button>` : ''} <button class="btn-delete" onclick="onDeleteVoucher('${v.id}')"><i class="fas fa-trash"></i> L√∂schen</button> </div> </div> </div> `).join(''); } // Escape helper function escapeHtml(s='') { return String(s).replace(/[&<>"']/g, function(m){return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m];}); } // Filters document.querySelectorAll('.filter-btn').forEach(btn=>{ btn.addEventListener('click', ()=>{ document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active')); btn.classList.add('active'); currentFilter = btn.dataset.filter; renderVouchers(); }); }); // Email modal function openEmailModal(voucherId){ selectedVoucher = vouchers.find(v=>v.id===voucherId); document.getElementById('emailModal').classList.add('active'); } function closeEmailModal(){ document.getElementById('emailModal').classList.remove('active'); document.getElementById('emailForm').reset(); selectedVoucher = null; } document.getElementById('emailForm').addEventListener('submit', (e)=>{ e.preventDefault(); const recipientEmail = document.getElementById('recipientEmail').value; const senderName = document.getElementById('senderName').value; if (!selectedVoucher) { alert('Kein Gutschein ausgew√§hlt'); closeEmailModal(); return; } alert(`Gutschein wird an ${recipientEmail} gesendet...\n\nPartner: ${selectedVoucher.partner}\nCode: ${selectedVoucher.code}`); // TODO: Hier E-Mail-Service integrieren closeEmailModal(); }); // Delete async function onDeleteVoucher(id){ if (!confirm('M√∂chten Sie diesen Gutschein wirklich l√∂schen?')) return; const res = await deleteVoucherBackend(id); if (res && res.isOk !== false) { showToast('Gutschein gel√∂scht', 'success'); await loadVouchersFromStorage(); updateStats(); renderVouchers(); } else { showToast('Fehler beim L√∂schen', 'error'); } } // Mobile menu (function setupMobile(){ const mobileMenu = document.getElementById('mobileMenu'); const navLinks = document.getElementById('navLinks'); mobileMenu?.addEventListener('click', ()=>navLinks.classList.toggle('active')); navLinks?.addEventListener('click', (e)=>{ if (e.target.tagName==='A') navLinks.classList.remove('active')}); })(); // Create modal controls document.getElementById('create-btn').addEventListener('click', ()=>document.getElementById('create-modal').classList.add('active')); document.getElementById('create-modal').addEventListener('click', (e)=>{ if (e.target===document.getElementById('create-modal')) document.getElementById('create-modal').classList.remove('active'); }); document.getElementById('create-cancel-btn').addEventListener('click', ()=>{ document.getElementById('create-modal').classList.remove('active'); document.getElementById('create-form').reset(); }); document.getElementById('create-form').addEventListener('submit', async (e)=>{ e.preventDefault(); if (vouchers.length >= 999) { showToast('Maximale Anzahl von 999 Gutscheinen erreicht','error'); return; } const submitBtn = document.getElementById('create-submit-btn'); submitBtn.disabled = true; submitBtn.textContent = 'Wird erstellt...'; const selected = document.getElementById('voucher-partner').value; const [partner, title, description] = selected.split('|'); const newVoucher = { id: Date.now().toString(), code: generateVoucherCode(), title: title || partner, description: description || '', partner: partner || title || 'Partner', value: title || '', createdAt: new Date().toISOString(), redeemedAt: '', isRedeemed: false }; const result = await createVoucherBackend(newVoucher); submitBtn.disabled = false; submitBtn.textContent = 'Gutschein erstellen'; if (result && result.isOk !== false) { showToast('Gutschein erfolgreich erstellt!'); document.getElementById('create-modal').classList.remove('active'); document.getElementById('create-form').reset(); // reload from storage/backend await loadVouchersFromStorage(); updateStats(); renderVouchers(); } else { showToast('Fehler beim Erstellen des Gutscheins','error'); } }); // Redeem modal controls document.getElementById('redeem-btn').addEventListener('click', ()=>document.getElementById('redeem-modal').classList.add('active')); document.getElementById('redeem-modal').addEventListener('click', (e)=>{ if (e.target===document.getElementById('redeem-modal')) document.getElementById('redeem-modal').classList.remove('active'); }); document.getElementById('redeem-cancel-btn').addEventListener('click', ()=>{ document.getElementById('redeem-modal').classList.remove('active'); document.getElementById('redeem-form').reset(); }); function openRedeemModalWithCode(code){ document.getElementById('redeem-code').value = code; document.getElementById('redeem-modal').classList.add('active'); } document.getElementById('redeem-form').addEventListener('submit', async (e)=>{ e.preventDefault(); const code = document.getElementById('redeem-code').value.toUpperCase().trim(); const voucher = vouchers.find(v => v.code === code && !v.isRedeemed); const submitBtn = document.getElementById('redeem-submit-btn'); submitBtn.disabled = true; submitBtn.textContent = 'Wird eingel√∂st...'; if (!voucher) { submitBtn.disabled = false; submitBtn.textContent = 'Einl√∂sen'; showToast('Gutschein nicht gefunden oder bereits eingel√∂st','error'); return; } const updated = {...voucher, isRedeemed:true, redeemedAt:new Date().toISOString()}; const result = await updateVoucherBackend(updated); submitBtn.disabled = false; submitBtn.textContent = 'Einl√∂sen'; if (result && result.isOk !== false) { showToast('Gutschein erfolgreich eingel√∂st!'); document.getElementById('redeem-modal').classList.remove('active'); document.getElementById('redeem-form').reset(); await loadVouchersFromStorage(); updateStats(); renderVouchers(); } else { showToast('Fehler beim Einl√∂sen','error'); } }); // Registration form (simple simulation) document.getElementById('registration-form').addEventListener('submit', (e)=>{ e.preventDefault(); const submitBtn = document.getElementById('register-btn'); submitBtn.disabled = true; submitBtn.textContent = 'Wird registriert...'; setTimeout(()=>{ submitBtn.disabled = false; submitBtn.textContent = 'Registrieren'; showToast('Registrierung erfolgreich! Willkommen bei Babsy Partnergutscheinen!'); document.getElementById('registration-form').reset(); }, 1200); }); // Initialization and elementSdk support async function onConfigChange(config){ const cfg = Object.assign({}, defaultConfig, config || {}); document.body.style.backgroundColor = cfg.background_color; document.querySelectorAll('.card').forEach(c=>c.style.backgroundColor = cfg.card_color); document.body.style.color = cfg.text_color; document.documentElement.style.setProperty('--primary-color', cfg.primary_action_color || cfg.primary_action_color); document.documentElement.style.setProperty('--secondary-color', cfg.secondary_action_color || cfg.secondary_action_color); document.getElementById('create-btn').textContent = `‚ú® ${cfg.create_button_text || defaultConfig.create_button_text}`; document.getElementById('redeem-btn').textContent = `üéÅ ${cfg.redeem_button_text || defaultConfig.redeem_button_text}`; } const dataHandler = { onDataChanged(data){ // if dataSdk notifies, reflect it if (Array.isArray(data)) { vouchers = data.sort((a,b)=>new Date(b.createdAt)-new Date(a.createdAt)); updateStats(); renderVouchers(); } } }; async function init(){ // elementSdk if (window.elementSdk && window.elementSdk.init) { window.elementSdk.init({ defaultConfig, onConfigChange, mapToCapabilities: (config)=>({}), mapToEditPanelValues: (config)=>new Map() }); await onConfigChange(window.elementSdk?.config || defaultConfig); } else { await onConfigChange(defaultConfig); } // dataSdk if (window.dataSdk && window.dataSdk.init) { const initRes = await window.dataSdk.init(dataHandler).catch(()=>({isOk:false})); if (!initRes || initRes.isOk === false) { // fallback to localStorage } } // load vouchers from backend or storage await loadVouchersFromStorage(); updateStats(); renderVouchers(); } // helper to open email modal externally window.openEmailModal = openEmailModal; window.closeEmailModal = closeEmailModal; window.onDeleteVoucher = onDeleteVoucher; window.openRedeemModalWithCode = openRedeemModalWithCode; document.addEventListener('DOMContentLoaded', init); </script></body> </html>
